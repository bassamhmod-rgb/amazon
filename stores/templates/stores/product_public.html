<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>{{ product.name }} â€“ {{ store.name }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">

    <style>
        :root {
            --primary-color: #4C1D95;
            --accent-color: #7C3AED;
            --soft-bg: #F3E8FF;
            --text-dark: #1a1333;
            --text-light: #6d5b9b;
        }

        body {
            font-family: "Cairo", sans-serif;
            background: var(--soft-bg);
            color: var(--text-dark);
        }

        .product-card {
            background: #fff;
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 8px 24px rgba(76, 29, 149, 0.15);
            border: 1px solid #e4d7ff;
        }

        .main-image {
            border-radius: 16px;
            overflow: hidden;
            height: 380px;
            box-shadow: 0 8px 22px rgba(0,0,0,0.2);
            border: 1px solid #eee;
        }

        .main-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #fff;
        }

        .gallery-img {
            height: 90px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid transparent;
            cursor: pointer;
            transition: .2s;
        }

        .gallery-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-img:hover {
            border-color: var(--accent-color);
        }

        .product-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .product-price {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .spec-table {
            background: #faf5ff;
            border: 1px solid #e3d4ff;
            border-radius: 12px;
            padding: 1rem;
        }

        .spec-row {
            padding: 0.4rem 0;
            border-bottom: 1px solid #e6d9ff;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø²Ø± Ø§Ù„Ø´Ø±Ø§Ø¡ */
        .btn-buy {
            background: var(--accent-color);
            color: #fff;
            padding: 0.8rem 1.4rem;
            border-radius: 12px;
            border: none;
            font-weight: 700;
            transition: .25s;
            width: 100%; /* Ø¬Ø¹Ù„ Ø§Ù„Ø²Ø± ÙŠØ£Ø®Ø° ÙƒØ§Ù…Ù„ Ø§Ù„Ø¹Ø±Ø¶ */
        }

        .btn-buy:hover {
            background: var(--primary-color);
        }

        .back-link {
            margin-top: 1.2rem;
            display: inline-block;
            font-weight: 600;
            color: var(--primary-color);
            text-decoration: none;
        }

        .back-link:hover {
            color: var(--accent-color);
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø«ÙŠÙ… */
        .custom-input {
            border: 1px solid #e3d4ff;
            border-radius: 10px;
            padding: 0.6rem;
        }
        .custom-input:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 0.2rem rgba(124, 58, 237, 0.25);
        }
        .form-label-sm {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 4px;
            display: block;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="product-card">

        <div class="row g-4">

            <div class="col-md-5">

                <div class="main-image mb-3">
                    {% if product.main_image %}
                        <img id="mainDisplay" src="{{ product.main_image.url }}" alt="">
                    {% else %}
                        <img id="mainDisplay" src="https://via.placeholder.com/500x350">
                    {% endif %}
                </div>

                <div class="row g-2">
                    {% for img in product.gallery.all %}
                    <div class="col-3 gallery-img" onclick="changeMainImage('{{ img.image.url }}')">
                        <img src="{{ img.image.url }}">
                    </div>
                    {% endfor %}
                </div>

            </div>

            <div class="col-md-7">

                <h1 class="product-title">{{ product.name }}</h1>

                <div class="product-price">{{ product.price|floatformat:2 }} $</div>

                <p><strong>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø©:</strong> {{ product.real_stock }}</p>
                <p><strong>Ø§Ù„ÙØ¦Ø©:</strong>
                    {% if product.category %}
                        {{ product.category.name }}
                    {% else %}
                        â€”â€” 
                    {% endif %}
                </p>
                <p><strong>Ø§Ù„ÙØ¦Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ©:</strong>
                    {% if product.category2 %}
                           {{ product.category2.name }}
                    {% else %}
        â€”â€” 
                    {% endif %}
                </p>


                {% if product.description %}
                <p>{{ product.description|linebreaks }}</p>
                {% endif %}

                {% if product.details.all %}
                <h4 class="mt-4 mb-2">Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª</h4>

                <div class="spec-table mb-4">
                 {% for d in product.details.all %}
                    <div class="spec-row">
                          <div class="row">
                             <div class="col-4 text-end fw-bold">
                               {{ d.title }}
                             </div>
                             <div class="col-8 text-start">
                              {{ d.value }}
                             </div>
                          </div>
                    </div>
                 {% endfor %}
                </div>
                {% endif %}

                        <form method="POST" action="{% url 'cart:add_to_cart' store.slug product.id %}">                    
                                 {% csrf_token %}  <div class="row g-2 mb-3"></div>
                            <div class="row g-2 mb-3">
                        <div class="col-3">
                            <label class="form-label-sm">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
                            <input type="number" name="quantity" value="1" min="1" class="form-control custom-input text-center">
                        </div>

                        <div class="col-9">
                            <label class="form-label-sm">Ù…Ù„Ø§Ø­Ø¸Ø© (Ù„ÙˆÙ†ØŒ Ù‚ÙŠØ§Ø³..)</label>
                            <input type="text" name="item_note" class="form-control custom-input" placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ù‡Ù†Ø§...">
                        </div>
                    </div>

                    <button type="submit" class="btn-buy">
                        ğŸ›’ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
                    </button>
                </form>
                <div class="text-center">
                              <a href="{% url 'stores:store_front' store.slug %}" class="back-link">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ØªØ¬Ø±</a>
            </div>

        </div>

    </div>

</div>

<script>
    function changeMainImage(src) {
        document.getElementById("mainDisplay").src = src;
    }
</script>

</body>
</html>